<div class="container py-4">
  <h2>Anguler 19 + Firebase Todo App</h2>
  <form [formGroup]="todoFrom" (ngSubmit)="onSubmit()">
    <input class="form-control" type="text" formControlName="task" placeholder="Enter a task" [class.is-invalid]="
        todoFrom.get('task')?.invalid && todoFrom.get('task')?.touched
      " />

    <div class="text-danger">
      @if(todoFrom.get('task')?.errors?.['required'] &&
      todoFrom.get('task')?.touched){ Class is required }
    </div>

    <div class="text-danger">
      @if(todoFrom.get('task')?.errors?.['minlength'] &&
      todoFrom.get('task')?.touched){ Class is too short }
    </div>

    <div class="row">
      <div class="col-4">
        <button [disabled]="todoFrom.invalid" type="submit" class="btn btn-primary mt-3 px-4">
          {{ selectedTodo() ? "Update" : "Add" }}
        </button>
      </div>

      <div class="col-4 mt-3">
        <div>
          @if (selectedTodo()) {
          <button type="button" class="btn btn-info" (click)="cancelEdit()">
            Cancel Edit
          </button>
          }
        </div>
      </div>
      <div class="col-4"></div>
    </div>
  </form>
  <div class="mt-4">
    @if(successMessage()){
    <div class="alert alert-success">
      {{successMessage()}}
    </div>
    }
  </div>

  <table class="table">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Task</th>
        <th scope="col">Edit</th>
        <th scope="col">Delete</th>
      </tr>
    </thead>
    <tbody>
      @for(todo of todos(); track todo.id) {
      <tr>
        <td>
          <strong>{{ todo.task }}</strong>
        </td>
        <td>
          <button class="btn btn-warning" (click)="onEdit(todo)">Edit</button>
        </td>
        <td>
          <button class="btn btn-danger" (click)="onDelete(todo.id!)">Delete</button>
        </td>
      </tr>
      }
    </tbody>
  </table>


</div>